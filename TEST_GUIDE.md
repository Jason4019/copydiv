# 常用词插件测试指南

## 测试前准备

1. **加载扩展**
   - 打开 Edge 浏览器
   - 访问 `edge://extensions/`
   - 开启"开发人员模式"
   - 点击"加载解压缩的扩展"
   - 选择项目文件夹 `d:\Work\copydiv`

2. **打开开发者工具**
   - 按 `F12` 打开开发者工具
   - 查看 Console 标签页，检查是否有错误

## 测试清单

### 一、Options 页面测试（设置页面）

#### 1.1 页面加载测试
- [ ] 打开设置页面（右键扩展图标 → 选项，或访问 `edge://extensions/` → 找到扩展 → 点击"选项"）
- [ ] 检查页面是否正常显示
- [ ] 检查是否有"添加常用词"表单
- [ ] 检查是否显示"常用词列表"区域
- [ ] 初始状态应显示"暂无常用词，请添加常用词"

#### 1.2 添加常用词测试
- [ ] **正常添加**
  - 在输入框输入"测试词1"
  - 点击"添加"按钮
  - 检查是否成功添加到列表
  - 检查是否显示成功提示"常用词添加成功！"
  - 检查输入框是否清空

- [ ] **回车键添加**
  - 在输入框输入"测试词2"
  - 按 `Enter` 键
  - 检查是否成功添加

- [ ] **输入验证 - 空值**
  - 不输入任何内容，直接点击"添加"
  - 检查是否显示错误提示"请输入常用词"

- [ ] **输入验证 - 长度限制**
  - 输入超过100个字符的文本
  - 检查是否显示错误提示"常用词长度不能超过100个字符"

- [ ] **重复检查**
  - 尝试添加已存在的常用词
  - 检查是否显示错误提示"该常用词已存在"

#### 1.3 编辑常用词测试
- [ ] **打开编辑模态框**
  - 点击某个常用词的"编辑"按钮
  - 检查是否弹出编辑模态框
  - 检查输入框是否预填充了原文本

- [ ] **保存编辑**
  - 修改文本内容
  - 点击"保存"按钮
  - 检查列表是否更新
  - 检查是否显示成功提示"常用词更新成功！"

- [ ] **回车保存**
  - 在编辑模态框中修改内容
  - 按 `Enter` 键
  - 检查是否保存成功

- [ ] **取消编辑**
  - 打开编辑模态框
  - 修改内容
  - 点击"取消"按钮或按 `ESC` 键
  - 检查是否关闭模态框且内容未保存

- [ ] **点击外部关闭**
  - 打开编辑模态框
  - 点击模态框外部区域
  - 检查是否关闭模态框

- [ ] **编辑验证**
  - 尝试将文本改为空值
  - 检查是否显示错误提示
  - 尝试改为已存在的词
  - 检查是否显示重复提示

#### 1.4 删除常用词测试
- [ ] **删除确认**
  - 点击某个常用词的"删除"按钮
  - 检查是否弹出确认对话框
  - 点击"取消"，检查是否未删除
  - 再次点击"删除"，点击"确定"
  - 检查是否从列表中移除
  - 检查是否显示成功提示"常用词已删除"

#### 1.5 列表渲染测试
- [ ] **空状态**
  - 删除所有常用词
  - 检查是否显示"暂无常用词，请添加常用词"

- [ ] **多词显示**
  - 添加多个常用词（至少5个）
  - 检查列表是否正确显示所有词
  - 检查每个词是否都有"编辑"和"删除"按钮

- [ ] **长文本处理**
  - 添加一个很长的常用词（接近100字符）
  - 检查是否正常显示，文本是否换行

### 二、Popup 页面测试（弹出窗口）

#### 2.1 页面加载测试
- [ ] 点击浏览器工具栏的扩展图标
- [ ] 检查弹出窗口是否正常显示
- [ ] 初始无词时，检查是否显示"暂无常用词"和"前往设置添加"链接

#### 2.2 读取常用词列表测试
- [ ] 在设置页面添加几个常用词
- [ ] 打开 popup 窗口
- [ ] 检查是否显示所有常用词按钮
- [ ] 检查按钮文本是否正确

#### 2.3 复制功能测试
- [ ] **正常复制**
  - 点击某个常用词按钮
  - 检查是否显示成功提示"已复制：xxx"
  - 打开记事本或任意文本编辑器
  - 按 `Ctrl+V` 粘贴
  - 检查粘贴的内容是否正确

- [ ] **多次复制**
  - 依次点击不同的常用词按钮
  - 检查每次是否都能正确复制
  - 检查提示是否正确更新

#### 2.4 自动刷新测试
- [ ] **添加后自动刷新**
  - 保持 popup 窗口打开
  - 在另一个标签页打开设置页面
  - 添加一个新常用词
  - 检查 popup 窗口是否自动显示新词（无需手动刷新）

- [ ] **编辑后自动刷新**
  - 保持 popup 窗口打开
  - 在设置页面编辑一个常用词
  - 检查 popup 窗口是否自动更新

- [ ] **删除后自动刷新**
  - 保持 popup 窗口打开
  - 在设置页面删除一个常用词
  - 检查 popup 窗口是否自动移除该词

#### 2.5 跳转设置测试
- [ ] 当没有常用词时
  - 点击"前往设置添加"链接
  - 检查是否打开设置页面

### 三、数据持久化测试

#### 3.1 存储测试
- [ ] 添加几个常用词
- [ ] 关闭浏览器
- [ ] 重新打开浏览器
- [ ] 打开设置页面
- [ ] 检查常用词是否仍然存在

#### 3.2 同步测试（如果使用多设备）
- [ ] 在一个设备上添加常用词
- [ ] 在另一个设备上登录相同账户
- [ ] 检查常用词是否同步（chrome.storage.sync 会同步到云端）

### 四、边界情况测试

#### 4.1 特殊字符测试
- [ ] 添加包含特殊字符的词：`!@#$%^&*()`
- [ ] 添加包含换行符的词
- [ ] 添加包含 emoji 的词：`😀测试词🎉`
- [ ] 检查是否都能正常保存和显示

#### 4.2 性能测试
- [ ] 添加大量常用词（50+）
- [ ] 检查列表渲染是否流畅
- [ ] 检查 popup 窗口滚动是否正常

#### 4.3 并发操作测试
- [ ] 同时打开设置页面和 popup 窗口
- [ ] 在设置页面添加/编辑/删除
- [ ] 检查 popup 是否实时更新

## 常见问题排查

### 问题1：扩展无法加载
- 检查 `manifest.json` 语法是否正确
- 检查所有引用的文件是否存在
- 查看开发者工具 Console 的错误信息

### 问题2：常用词无法保存
- 检查浏览器是否允许扩展使用存储权限
- 查看 Console 是否有存储相关的错误
- 检查 `chrome.storage.sync` 是否可用

### 问题3：复制功能不工作
- 检查是否在 HTTPS 页面或 localhost（Clipboard API 要求）
- 检查浏览器是否允许剪贴板访问
- 查看 Console 是否有权限错误

### 问题4：自动刷新不工作
- 检查 `chrome.storage.onChanged` 监听器是否正确设置
- 确认两个页面都监听了存储变化事件

## 测试结果记录

| 测试项 | 状态 | 备注 |
|--------|------|------|
| Options 页面加载 | ⬜ | |
| 添加常用词 | ⬜ | |
| 编辑常用词 | ⬜ | |
| 删除常用词 | ⬜ | |
| Popup 页面加载 | ⬜ | |
| 复制功能 | ⬜ | |
| 自动刷新 | ⬜ | |
| 数据持久化 | ⬜ | |

## 快速测试脚本

可以在浏览器 Console 中运行以下代码进行快速测试：

```javascript
// 测试数据存储
chrome.storage.sync.set({ 
  commonWords: [
    { id: 1, text: '测试词1', createdAt: Date.now() },
    { id: 2, text: '测试词2', createdAt: Date.now() }
  ] 
}, () => {
  console.log('测试数据已设置');
});

// 读取数据
chrome.storage.sync.get(['commonWords'], (result) => {
  console.log('当前常用词:', result.commonWords);
});

// 清空数据
chrome.storage.sync.set({ commonWords: [] }, () => {
  console.log('数据已清空');
});
```
